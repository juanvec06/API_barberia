<!--
  Descripción: Plantilla para la vista principal del cliente. Define un layout de dos
  columnas adaptable (responsive) que muestra una barra lateral de categorías y una
  cuadrícula de productos.
-->
<div class="container-fluid mt-4 py-5">
    <!-- Fila principal que estructura el layout de la página. -->
    <div class="row">

        <!--
          =======================================================
          === Columna 1: Barra Lateral de Filtro de Categorías ===
          =======================================================
          Utiliza el sistema de rejilla de Bootstrap para su comportamiento responsive:
          - col-12: Ocupa el ancho completo en pantallas muy pequeñas (<576px), apilándose.
          - col-sm-2: Ocupa 2 de 12 columnas en pantallas pequeñas (>=576px).
          - col-md-4: Ocupa 4 de 12 columnas en pantallas medianas (>=768px).
        -->
        <aside class="col-12 col-sm-2 col-md-4">
            <h2 class="sidebar-title mb-3">Categorías</h2>

            <!-- Componente `list-group` de Bootstrap para presentar la lista de categorías. -->
            <div class="list-group">
                <!--
                  Opción estática para mostrar todos los productos.
                  - [class.active]: Enlace de clase que aplica el estilo 'active' si
                    `selectedCategoryId` en el componente es `null`.
                  - (click): Llama al método `selectCategory` con `null` para desactivar el filtro.
                -->
                <a class="list-group-item list-group-item-action" [class.active]="selectedCategoryId === null"
                    (click)="selectCategory(null)">
                    Todas las categorías
                </a>
                <!--
                  Iteración sobre la lista de categorías obtenida desde el componente.
                  - *ngFor: Directiva estructural de Angular que crea un elemento `<a>` por cada
                    categoría en el arreglo `categorias`.
                  - [class.active]: Aplica el estilo 'active' si el `id` de la categoría actual
                    coincide con `selectedCategoryId`.
                  - (click): Llama a `selectCategory` con el `id` de la categoría clicada.
                -->
                <a *ngFor="let cat of categorias" class="list-group-item list-group-item-action"
                    [class.active]="cat.id === selectedCategoryId" (click)="selectCategory(cat.id)">
                    {{ cat.nombre }}
                </a>
            </div>
        </aside>

        <!--
          ===================================================
          === Columna 2: Cuadrícula de Productos/Servicios ===
          ===================================================
          Comportamiento responsive complementario a la barra lateral:
          - col-12: Ancho completo en pantallas muy pequeñas.
          - col-sm-10: Ocupa las 10 columnas restantes en pantallas pequeñas.
          - col-md-8: Ocupa las 8 columnas restantes en pantallas medianas.
        -->
        <main class="col-12 col-sm-10 col-md-8">
            <h2 class="products-title mb-4">Nuestros Servicios</h2>

            <!--
              Contenedor de la cuadrícula de productos.
              - `row-cols-*`: Clases de Bootstrap que controlan cuántas tarjetas se muestran por fila
                en diferentes tamaños de pantalla (breakpoints), creando un grid responsive.
                - 1 columna en pantallas muy pequeñas.
                - 3 columnas en pantallas 'sm'.
                - 4 columnas en pantallas 'md'.
                - 6 columnas en pantallas 'lg'.
              - g-4: Añade un espaciado (gutter) entre las tarjetas.
            -->
            <div class="row row-cols-1 row-cols-sm-3 row-cols-md-4 row-cols-lg-6 g-4">
                <!--
                  Itera sobre la lista `filteredProducts` del componente. Esta lista
                  contiene solo los productos que deben mostrarse según el filtro actual.
                -->
                <div *ngFor="let producto of filteredProducts" class="col product-card-container">
                    <!--
                      Tarjeta de producto individual.
                      - h-100: Asegura que todas las tarjetas en una misma fila tengan la misma altura.
                      - product-card: Clase personalizada para el efecto de volteo 3D.
                    -->
                    <div class="card h-100 product-card">
                        <!-- === CARA FRONTAL DE LA TARJETA === -->
                        <div class="card-front">
                            <!-- Etiqueta de categoría posicionada sobre la imagen. -->
                            <span *ngIf="producto.objCategoria" class="category-badge">
                                {{ producto.objCategoria.nombre }}
                            </span>

                            <!-- Imagen del producto. `[src]` hace un enlace de propiedad a la URL de la imagen. -->
                            <img [src]="producto.imagen" class="card-img-top" [alt]="producto.nombre">

                            <!-- Cuerpo de la tarjeta con nombre y precio. -->
                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">{{ producto.nombre }}</h5>
                                <!--
                                  `mt-auto` empuja el precio al fondo del `card-body`.
                                  El pipe `currency` formatea el valor numérico como moneda local (COP).
                                -->
                                <p class="card-text price mt-auto">{{ producto.precio | currency:'COP':'symbol':'1.0-0' }}</p>
                            </div>

                            <!-- Etiqueta de estado (Disponible/No Disponible) con color condicional. -->
                            <span *ngIf="producto.estado === true" class="badge bg-success">Disponible</span>
                            <span *ngIf="producto.estado === false" class="badge bg-danger">No Disponible</span>
                        </div>

                        <!-- === CARA TRASERA DE LA TARJETA === -->
                        <div class="card-back d-flex flex-column p-3">
                            <h5 class="card-title-back">{{ producto.nombre }}</h5>
                            <p class="card-text-back">{{ producto.descripcion }}</p>
                            <!-- `mt-auto` empuja la duración a la parte inferior de la tarjeta. -->
                            <div class="mt-auto text-center">
                                <span class="duration-badge">
                                    <i class="bi bi-clock-fill me-1"></i> <!-- Icono de Bootstrap Icons -->
                                    {{ producto.duracionMin }} min
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!--
              Mensaje que se muestra condicionalmente con `*ngIf` solo si la lista
              de productos filtrados está vacía.
            -->
            <div *ngIf="filteredProducts.length === 0" class="text-center mt-5 no-products-message">
                <p>No hay servicios disponibles en esta categoría.</p>
            </div>
        </main>

    </div>
</div>