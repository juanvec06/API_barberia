<!-- Ruta: src/app/ver-productos-por-categorias/ver-productos-por-categorias.component.html -->
<div class="container-fluid mt-4 py-5">
    <!-- Fila principal que contendrá nuestras dos columnas -->
    <div class="row">

        <!-- Columna 1: Barra Lateral de Categorías -->
        <!--
      Clases de Bootstrap explicadas:
      - col-12: En el tamaño más pequeño (xs), ocupa todo el ancho (12 columnas).
      - col-sm-2: A partir del tamaño pequeño (sm), ocupa 2 de 12 columnas.
      - col-md-4: A partir del tamaño mediano (md), ocupa 4 de 12 columnas.
      Bootstrap aplica la clase más grande que corresponda al tamaño de la pantalla.
    -->
        <aside class="col-12 col-sm-2 col-md-4">
            <h2 class="sidebar-title mb-3">Categorías</h2>

            <!--  list-group de Bootstrap para la lista -->
            <div class="list-group">
                <!--
      - *ngFor recorre el array de categorías.
      - [class.active] añade la clase 'active' SÓLO si el id de la categoría actual
        coincide con el 'selectedCategoryId' de nuestro componente.
      - (click) llama al método 'selectCategory' pasándole el id de la categoría
        en la que se hizo clic.

    -->
                <a class="list-group-item list-group-item-action" [class.active]="selectedCategoryId === null"
                    (click)="selectCategory(null)">
                    Todas las categorías
                </a>
                <a *ngFor="let cat of categorias" class="list-group-item list-group-item-action"
                    [class.active]="cat.id === selectedCategoryId" (click)="selectCategory(cat.id)">
                    {{ cat.nombre }}
                </a>
            </div>
        </aside>

        <!-- Columna 2: Sección de Productos -->
        <!--
      Clases de Bootstrap explicadas:
      - col-12: En el tamaño más pequeño (xs), ocupa todo el ancho.
      - col-sm-10: A partir del tamaño pequeño (sm), ocupa las 10 columnas restantes.
      - col-md-8: A partir del tamaño mediano (md), ocupa las 8 columnas restantes.
    -->
        <main class="col-12 col-sm-10 col-md-8">
            <h2 class="products-title mb-4">Nuestros Servicios</h2>

            <!-- Fila que contendrá todas las tarjetas de productos -->
            <!--
    Clases de Bootstrap explicadas:
    - row-cols-sm-3: A partir de 576px, muestra 3 columnas (tarjetas) por fila.
    - row-cols-md-4: A partir de 768px, muestra 4 columnas por fila.
    - row-cols-lg-6: A partir de 992px, muestra 6 columnas por fila.
    - g-4: Añade un espaciado (gutter) entre las columnas y filas.
  -->
            <div class="row row-cols-1 row-cols-sm-3 row-cols-md-4 row-cols-lg-6 g-4">
                <!-- Iteramos sobre la lista de productos FILTRADOS -->
                <div *ngFor="let producto of filteredProducts" class="col product-card-container">
                    <div class="card h-100 product-card">
                        <!-- CARA FRONTAL DE LA TARJETA -->
                        <div class="card-front">
                            <img src="https://picsum.photos/300/200" class="card-img-top" [alt]="producto.nombre">

                            <div class="card-body d-flex flex-column">
                                <h5 class="card-title">{{ producto.nombre }}</h5>
                                <p class="card-text price mt-auto">{{ producto.precio | currency:'COP':'symbol':'1.0-0'
                                    }}</p>
                            </div>

                            <!-- Badge para el estado  -->
                            <span *ngIf="producto.estado === 'Disponible'"
                                class="badge bg-success product-badge">Disponible</span>
                            <span *ngIf="producto.estado === 'No Disponible'" class="badge bg-danger product-badge">No
                                Disponible</span>
                        </div>

                        <!-- CARA TRASERA DE LA TARJETA -->
                        <div class="card-back d-flex flex-column p-3">
                            <h5 class="card-title-back">{{ producto.nombre }}</h5>
                            <p class="card-text-back">{{ producto.descripcion }}</p>
                            <div class="mt-auto text-end">
                                <span class="duration-badge">
                                    <i class="bi bi-clock-fill me-1"></i>
                                    {{ producto.duracion }}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Mensaje por si no hay productos en la categoría seleccionada -->
            <div *ngIf="filteredProducts.length === 0" class="text-center mt-5 no-products-message">
                <p>No hay servicios disponibles en esta categoría.</p>
            </div>
        </main>

    </div>
</div>